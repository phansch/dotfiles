---
- hosts: localhost
  become: true
  become_method: sudo
  roles:
    - role: spotify
    - role: i3
    - role: rust
    - role: markdown_mimetype
    - role: FGtatsuro.vagrant
  tasks:
    - name: Install additional apt packages
      apt:
        pkg:
          - unclutter
          - shutter
          - libreoffice-calc
          - deja-dup
          - jq
          - redshift
          - ctags
          - newsbeuter
          - sqlitebrowser
        state: present
        update_cache: true
    - name: Create tmp download dir
      file: path=/tmp/ansible-debs state=directory
    - name: Install additional deb packages
      apt: deb={{ item }} state=present
      with_items:
        - https://go.skype.com/skypeforlinux-64.deb
    - name: Setup various ppa repositories
      shell: add-apt-repository -y {{ item }}
      with_items:
        - ppa:neovim-ppa/unstable
        - ppa:ubuntu-mozilla-daily/ppa
        - ppa:phoerious/keepassxc
    - name: Install packages from ppas
      apt:
        pkg:
          - firefox-trunk
          - neovim
          - keepassxc
        update_cache: true
    - name: Install python3-pip
      apt: name=python3-pip
    - name: Install python packages for neovim
      pip:
        name: neovim
        executable: pip3
    - name: Install neovim
      apt: name=neovim update_cache=yes
    - name: Set nvim as vi alternative
      shell: update-alternatives --install /usr/bin/vi vi /usr/bin/nvim 60
    - name: Set nvim as vim alternative
      shell: update-alternatives --install /usr/bin/vim vim /usr/bin/nvim 60
    - name: Set nvim as editor alternative
      shell: update-alternatives --install /usr/bin/editor editor /usr/bin/nvim 60
    - name: Anki Latest
      unarchive:
        src: https://apps.ankiweb.net/downloads/current/anki-2.1.9-linux-amd64.tar.bz2
        dest: /opt
        remote_src: yes
    - name: Rename extracted folder
      command: mv --no-clobber /opt/anki-2.1.9-linux-amd64 /opt/anki
    - name: Symlink moved anki executable
      file:
        src: /opt/anki/bin/anki
        dest: /usr/bin/anki
        state: link
    - name: Install tmuxifier
      become: no
      git:
        repo: https://github.com/jimeh/tmuxifier.git
        dest: ~/.tmuxifier
